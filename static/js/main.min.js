function moved(){sites[0]=d3.mouse(this),redraw()}function redraw(){var t=voronoi(sites);polygon=polygon.data(t.polygons()).call(redrawPolygon),link=link.data(t.links()),link.exit().remove(),link=link.enter().append("line").merge(link).call(redrawLink),site=site.data(sites).call(redrawSite)}function redrawPolygon(t){t.attr("d",function(t){return t?"M"+t.join("L")+"Z":null})}function redrawLink(t){t.attr("x1",function(t){return t.source[0]}).attr("y1",function(t){return t.source[1]}).attr("x2",function(t){return t.target[0]}).attr("y2",function(t){return t.target[1]})}function redrawSite(t){t.attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]})}var svg=d3.select("svg").on("touchmove mousemove",moved),width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height=1e3,sites=d3.range(75).map(function(t){return[Math.random()*width,Math.random()*height]}),voronoi=d3.voronoi().extent([[-1,-1],[width+1,height+1]]),polygon=svg.append("g").attr("class","polygons").selectAll("path").data(voronoi.polygons(sites)).enter().append("path").call(redrawPolygon),link=svg.append("g").attr("class","links").selectAll("line").data(voronoi.links(sites)).enter().append("line").call(redrawLink),site=svg.append("g").attr("class","sites").selectAll("circle").data(sites).enter().append("circle").attr("r",2).call(redrawSite);